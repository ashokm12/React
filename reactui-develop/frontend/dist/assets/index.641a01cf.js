var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,o=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&s(e,a,t[a]);if(n)for(var a of n(t))l.call(t,a)&&s(e,a,t[a]);return e},c=(e,n)=>t(e,a(n)),i=(e,t,a)=>(s(e,"symbol"!=typeof t?t+"":t,a),a);import{c as d,R as m,m as u,r as p,C as E,B as y,U as h,a as g,I as f,S as v,b as N,M as w,L as C,T as b,$ as x,d as S,D as k,f as _,V as T,K as I,e as D,g as R,h as A,O as L,i as M,j as O,k as P,l as F,n as U,o as j,G as H,p as $,q as G,s as z,t as B,u as J,v as q,w as K,x as V,y as W,z as Y,A as X,E as Z,F as Q,H as ee,J as te,N as ae,P as ne,Q as re}from"./vendor.dd1d1c67.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var se=d((({reducer:e})=>({reducer:e})),{})((({reducer:{showMenu:e,common:{incidentName:t}}})=>m.createElement("div",{className:"flex justify-between items-center p-4 font-semibold fixed top-0 left-0 right-0 z-30",style:{background:"#d9e6f4"}},m.createElement("div",null,"Situation Awareness & Collaboration Tool"),m.createElement("div",null,t))));const oe={};function ce(e){return fetch(e,{credentials:"include"}).then((t=>(oe[e]&&(clearTimeout(oe[e]),delete oe[e]),t.json().then((e=>({json:e,response:t}))).catch((()=>t.ok?Promise.resolve({response:t}):Promise.reject({status:t.status})))))).then((({json:e,response:t})=>(Array.isArray(e)?e={data:e}:"object"!=typeof e&&(e={}),e.isServerOK=!!t.ok,e.isServerOK?o({},e):Promise.reject(o({status:t.status},e)))))}const ie=Symbol("Call API");function de({endpoint:e,payload:t,method:a="POST",payloadAsIs:n,isPayloadJson:r,skipCsrfToken:l}){return new Promise(((s,c)=>{const i=new XMLHttpRequest;let d=t;n||(d=t);const m="multipart"===r?function(e){const t=void 0!==window.FormData;let a=t?new FormData:"";return Object.keys(e).filter((t=>null!==e[t])).forEach((n=>{Array.isArray(e[n])?e[n].forEach((e=>{t?a.append(`${n}`,e):a=`${a}${n}=${e}&`})):"object"==typeof e[n]&&e[n].name?t&&a.append(`${n}`,e[n],e[n].name):t?a.append(`${n}`,e[n]):a=`${a}${n}=${e[n]}&`})),a}(d):(e=>{let t,a="",n=[];for(t in e)n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return a=n.join("&").replace(/%20/g,"+"),a})(d);i.open(a,e,!0),i.withCredentials=!0,l||i.setRequestHeader("X-CSRFToken",function(e){let t=null;if(document.cookie&&""!==document.cookie){const a=document.cookie.split(";");for(let n=0;n<a.length;n++){const r=a[n].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}}return t}("csrftoken")||""),"multipart"===r?i.setRequestHeader("Content-type","multipart/form-data"):i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onload=()=>{i.status>=200&&i.status<400?function(e,t){const a=204===e.status?{}:JSON.parse(e.responseText);t(o({isServerOK:!0},a))}(i,s):function(e,t,{endpoint:a,payload:n}){const{status:r,responseText:l}=e;switch(r){case 401:window.location.href="https://sellerpad.io/main/#/login";break;case 403:t({});break;case 429:t({json:JSON.parse(JSON.stringify({error:l})),status:r});break;default:try{t({json:l,status:r})}catch(s){t({json:{},status:r})}}}(i,c,{endpoint:e,payload:t})},i.send(m)}))}const me=Symbol("Post API");const ue=window.location.protocol+"//"+window.location.host,pe=ue+"/api/v1",Ee={fire:0,weather:1,tracking:2,data:3},ye=(e,t,a)=>{switch(e){case"wfs":case"arcgisent":case"arcgisonline":case"arcgisrest":const e=JSON.parse(t.attributes)&&JSON.parse(t.attributes).version;return`${t.datasource.internalurl}?service=WFS&version=${e||"1.0.0"}&request=GetFeature&typename=${t.layername}&outputFormat=application/json&srsname=EPSG:3857`;case"wms":case"georss":return`${t.datasource.internalurl}?&LAYERS=${t.layername}&`;case"kml":case"kmz":case"geojson":case"gpx":return`https://cognisite.scout-ca.net/nics/proxy.jsp?${t.layername}`;default:return""}},he=()=>({[ie]:{endpoint:pe+"/workspace",types:["____","FETCH_WORKSPACE_SUCCESS","___"],onSuccess:(e,t,a)=>{if(e.workspaces&&e.workspaces.length){const t=e.workspaces.filter((e=>e.enabled));t.length&&(a(ge(t[0].workspaceid)),a(fe()))}}}}),ge=e=>({[ie]:{endpoint:`${pe}/incidents/${e}/incidenttype`,types:["____","FETCH_INCIDENT_TYPE_SUCCESS","___"]}}),fe=()=>({[ie]:{endpoint:e=>`${pe}/users/${e.reducer.workspaceId}/userOrgs?userName=${e.reducer.user.email}`,types:["____","FETCH_USER_DETAIL_SUCCESS","___"],onSuccess:(e,t,a)=>{a({[me]:{endpoint:e=>`${pe}/users/${e.reducer.workspaceId}/createsession?userId=${e.reducer.userDetails.userId}&displayName=${e.reducer.user.email}&userOrgId=${e.reducer.userDetails.userOrgs[0].userorgid}&systemRoleId=${e.reducer.userDetails.userOrgs[0].systemroleid}&sessionId=${e.reducer.user.sessionId}`,types:["____","GET_SESSION_SUCCESS","___"],isPayloadJson:!0,payload:{}}})}}}),ve=()=>({[ie]:{endpoint:e=>`${pe}/folder/${e.reducer.workspaceId}/name/Fire`,types:["____","FETCH_FIRE_SUCCESS","___"],onSuccess:(e,t,a)=>{e.folders.forEach((e=>{a(Ce("fire",e.folderid))}))}}}),Ne=()=>({[ie]:{endpoint:e=>`${pe}/folder/${e.reducer.workspaceId}/name/Weather`,types:["____","FETCH_WEATHER_SUCCESS","___"],onSuccess:(e,t,a)=>{e.folders.forEach((e=>{a(Ce("weather",e.folderid))}))}}}),we=()=>({[ie]:{endpoint:e=>`${pe}/folder/${e.reducer.workspaceId}/name/Tracking`,types:["____","FETCH_TRACKING_SUCCESS","___"],onSuccess:(e,t,a)=>{e.folders.forEach((e=>{a(Ce("tracking",e.folderid))}))}}}),Ce=(e,t)=>({[ie]:{endpoint:e=>`${pe}/folder/${e.reducer.workspaceId}/id/${t}`,types:["____","FETCH_FOLDER_DATA_SUCCESS","___"],onSuccess:(t,a,n)=>n(be(t,e))}}),be=(e,t)=>({type:"HANDLE_FOLDER_DATA",response:e,folderType:t}),xe=e=>({type:"HANDLE_INCIDENT_NAME",name:e}),Se=(e,t,a)=>({type:"HANDLE_LAYER_CHECK_FLAG",key:e,flag:t,flagKey:a}),ke=e=>({type:"HANDLE_PROPERTY_MODAL_CHANGE",val:e}),{Panel:_e}=E,{Option:Te}=v,Ie={wms:"WMS",wfs:"WFS",arcgOnline:"ArcGIS Online",arcgEnt:"ArcGIS Enterprise"};var De=d((({reducer:e})=>({reducer:e})),{fetchWfs:()=>({[ie]:{endpoint:e=>`${pe}/datalayer/${e.reducer.workspaceId}/sources/wfs`,types:["____","FETCH_WFS_SUCCESS","___"]}}),fetchWms:()=>({[ie]:{endpoint:e=>`${pe}/datalayer/${e.reducer.workspaceId}/sources/wms`,types:["____","FETCH_WMS_SUCCESS","___"]}}),fetchArcgisent:()=>({[ie]:{endpoint:e=>`${pe}/datalayer/${e.reducer.workspaceId}/sources/arcgisent`,types:["____","FETCH_ARCG_SUCCESS","___"]}}),fetchArcgOnline:()=>({[ie]:{endpoint:e=>`${pe}/datalayer/${e.reducer.workspaceId}/sources/arcgisonline`,types:["____","FETCH_ARCG_ONLINE_SUCCESS","___"]}}),handleGeoRss:()=>({[me]:{endpoint:e=>`${pe}/datalayer/${e.reducer.workspaceId}/sources/georss/georss/${e.reducer.userDetails.userOrgs[0].userorgid}/${e.reducer.currentSessionId}`,types:["____","HANDLE_GEORSS_SUCCESS","______"],payload:e=>o({usersessionid:e.reducer.currentSessionId},e.reducer.georss),onSuccess:()=>{u.success("Upload Successfully")}}}),handleGeoTiffChange:e=>({type:"HANDLE_GEOTIFF_CHANGE",obj:e}),handleGeoTiff:()=>({[me]:{endpoint:e=>`${pe}/datalayer/${e.reducer.workspaceId}/geotiff?isMosaic=${"on"===e.reducer.geotiff.mosaic?"true":"false"}`,types:["____","HANDLE_GEOTIFF_SUCCESS","______"],isPayloadJson:"multipart",payload:e=>o({},e.reducer.geotiff),onSuccess:()=>{u.success("Upload Successfully")}}}),handleGeoRssChange:e=>({type:"HANDLE_GEORSS_CHANGE",obj:e}),handleKml:()=>({[me]:{endpoint:e=>`${pe}/datalayer/${e.reducer.workspaceId}/sources/kml/document/${e.reducer.userDetails.userOrgs[0].userorgid}`,types:["____","HANDLE_KML_SUCCESS","______"],isPayloadJson:"multipart",payload:e=>o({usersessionid:e.reducer.currentSessionId},e.reducer.kml),onSuccess:()=>{u.success("Upload Successfully")}}}),handleKmlChange:e=>({type:"HANDLE_KML_CHANGE",obj:e})})((({reducer:e,fetchWfs:t,fetchWms:a,fetchArcgisent:n,fetchArcgOnline:r,handleGeoRss:l,handleGeoRssChange:s,handleGeoTiffChange:o,handleGeoTiff:c,handleKmlChange:i,handleKml:d})=>{const[u,C]=p.exports.useState(!1),[b,x]=p.exports.useState(""),{wfs:S,wms:k,arcgent:_,arcon:T,georss:{feedUrl:I,displayname:D,refreshrate:R}={},geotiff:{filename:A,displayname:L,mosaic:M}={},kml:{displayname:O,refreshrate:P,fileURL:F}}=e;return p.exports.useEffect((()=>{t(),a(),n(),r()}),[]),m.createElement("div",{className:"mt-4"},m.createElement(E,null,m.createElement(_e,{header:"WFS"},S.datasources&&S.datasources.map(((e,t)=>m.createElement("div",{className:"border rounded-lg p-4 my-4 text-xs",key:t},m.createElement("div",{className:"flex justify-end text-xs text-green-500"},e.active?"Active":"Inactive"),m.createElement("div",{key:t,className:"mt-4 text-xs truncate"},"Name:"," ",m.createElement("span",{className:"ml-1 ",title:e.displayname},e.displayname)),m.createElement("div",{key:t,className:"mt-1 truncate text-xs",contenteditable:"true"},"URL: ",m.createElement("input",{className:"ml-1",value:e.internalurl})),m.createElement("div",{className:"flex justify-end items-center mt-4"},m.createElement("div",{className:"ml-4"},m.createElement(y,{type:"link",size:"small",onClick:()=>{C(!0),x("wfs")}},m.createElement("div",{className:"text-xs"},"Import"))))))))),m.createElement(E,null,m.createElement(_e,{header:"WMS"},k.datasources&&k.datasources.map(((e,t)=>m.createElement("div",{className:"border rounded-lg p-4 my-4",key:t},m.createElement("div",{className:"flex justify-end text-xs text-green-500"},e.active?"Active":"Inactive"),m.createElement("div",{key:t,className:"mt-4 text-xs truncate"},"Name:"," ",m.createElement("span",{className:"ml-1 ",title:e.displayname},e.displayname)),m.createElement("div",{key:t,className:"mt-1 truncate text-xs",contenteditable:"true"},"URL: ",m.createElement("input",{className:"ml-1",value:e.internalurl})),m.createElement("div",{className:"flex justify-end items-center mt-4"},m.createElement("div",{className:"ml-4"},m.createElement(y,{type:"link",size:"small",onClick:()=>{C(!0),x("wms")}},m.createElement("div",{className:"text-xs"},"Import"))))))))),m.createElement(E,null,m.createElement(_e,{header:"ArcGIS Enterprise"},_.datasources&&_.datasources.map(((e,t)=>m.createElement("div",{className:"border rounded-lg p-4 my-4",key:t},m.createElement("div",{className:"flex justify-end text-xs text-green-500"},e.active?"Active":"Inactive"),m.createElement("div",{key:t,className:"mt-4 text-xs truncate"},"Name:"," ",m.createElement("span",{className:"ml-1 ",title:e.displayname},e.displayname)),m.createElement("div",{key:t,className:"mt-1 truncate text-xs",contenteditable:"true"},"URL: ",m.createElement("input",{className:"ml-1",value:e.internalurl})),m.createElement("div",{className:"flex justify-end items-center mt-4"},m.createElement("div",{className:"ml-4"},m.createElement(y,{type:"link",size:"small",onClick:()=>{C(!0),x("wms")}},m.createElement("div",{className:"text-xs"},"Import"))))))))),m.createElement(E,null,m.createElement(_e,{header:"ArcGIS Online"},T.datasources&&T.datasources.map(((e,t)=>m.createElement("div",{className:"border rounded-lg p-4 my-4",key:t},m.createElement("div",{className:"flex justify-end text-xs text-green-500"},e.active?"Active":"Inactive"),m.createElement("div",{key:t,className:"mt-4 text-xs truncate"},"Name:"," ",m.createElement("span",{className:"ml-1 ",title:e.displayname},e.displayname)),m.createElement("div",{key:t,className:"mt-1 truncate text-xs",contenteditable:"true"},"URL: ",m.createElement("input",{className:"ml-1",value:e.internalurl})),m.createElement("div",{className:"flex justify-end items-center mt-4"},m.createElement("div",{className:"ml-4"},m.createElement(y,{type:"link",size:"small",onClick:()=>{C(!0),x("wms")}},m.createElement("div",{className:"text-xs"},"Import"))))))))),m.createElement(E,null,m.createElement(_e,{header:"KMZ"},m.createElement("div",{className:"text-xs"},m.createElement("div",null,m.createElement("div",null,"Choose a KMZ File"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"If File is remote, Enter URL"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Create Display Name in NICS"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Refresh Rate"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select"),m.createElement(Te,{value:"0:00"},"0.00"),m.createElement(Te,{value:"0:30"},"0.30"),m.createElement(Te,{value:"1:00"},"1.00"),m.createElement(Te,{value:"1:30"},"1.30"),m.createElement(Te,{value:"3:00"},"3.00"),m.createElement(Te,{value:"5:00"},"5.00")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to organization"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to Room"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full"},"Upload"))))),m.createElement(E,null,m.createElement(_e,{header:"KML"},m.createElement("div",{className:"text-xs"},m.createElement("div",null,m.createElement("div",null,"Choose a KML File"),m.createElement("input",{type:"file",accept:".kml",onChange:e=>i({fileName:e.target.files[0]})})),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"If File is remote, Enter URL"),m.createElement(f,{onChange:e=>i({fileURL:e.target.value}),value:F})),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Create Display Name in NICS"),m.createElement(f,{onChange:e=>i({displayname:e.target.value}),value:O})),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Refresh Rate"),m.createElement("div",null,m.createElement(v,{value:P,style:{width:"100%"},onChange:e=>i({refreshrate:e})},m.createElement(Te,{value:"",disabled:!0},"Select"),m.createElement(Te,{value:"0"},"0.00"),m.createElement(Te,{value:"30"},"0.30"),m.createElement(Te,{value:"60"},"1.00"),m.createElement(Te,{value:"90"},"1.30"),m.createElement(Te,{value:"180"},"3.00"),m.createElement(Te,{value:"300"},"5.00")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to organization"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to Room"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full",onClick:()=>d()},"Upload"))))),m.createElement(E,null,m.createElement(_e,{header:"GPX"},m.createElement("div",{className:"text-xs"},m.createElement("div",null,m.createElement("div",null,"Choose a GPX File"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"If File is remote, Enter URL"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Create Display Name in NICS"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Refresh Rate"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select"),m.createElement(Te,{value:"0:00"},"0.00"),m.createElement(Te,{value:"0:30"},"0.30"),m.createElement(Te,{value:"1:00"},"1.00"),m.createElement(Te,{value:"1:30"},"1.30"),m.createElement(Te,{value:"3:00"},"3.00"),m.createElement(Te,{value:"5:00"},"5.00")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to organization"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to Room"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full"},"Upload"))))),m.createElement(E,null,m.createElement(_e,{header:"GeoJson"},m.createElement("div",{className:"text-xs"},m.createElement("div",null,m.createElement("div",null,"Choose a GeoJson File"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"If File is remote, Enter URL"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Create Display Name in NICS"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Refresh Rate"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select"),m.createElement(Te,{value:"0:00"},"0.00"),m.createElement(Te,{value:"0:30"},"0.30"),m.createElement(Te,{value:"1:00"},"1.00"),m.createElement(Te,{value:"1:30"},"1.30"),m.createElement(Te,{value:"3:00"},"3.00"),m.createElement(Te,{value:"5:00"},"5.00")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to organization"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Restrict to Room"),m.createElement("div",null,m.createElement(v,{value:"",style:{width:"100%"},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full"},"Upload"))))),m.createElement(E,null,m.createElement(_e,{header:"Shape File"},m.createElement("div",{className:"text-xs"},m.createElement("div",null,m.createElement("div",null,"Choose a shape file to load as data layer"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Choose a shx file"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Choose a dbf file"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Choose a prj file"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Choose a sld file"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Display Name"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full"},"Upload"))))),m.createElement(E,null,m.createElement(_e,{header:"Image"},m.createElement("div",null,m.createElement("div",null,m.createElement("div",null,"Display Name"),m.createElement(f,null)),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Choose images to upload"),m.createElement(h,{style:{width:"100%"}},m.createElement(y,{icon:m.createElement(g,null),style:{width:"100%"}},m.createElement("span",{className:"text-xs"},"Upload")))),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full"},"Upload"))))),m.createElement(E,null,m.createElement(_e,{header:"GeoTIFF"},m.createElement("div",{className:"text-xs"},m.createElement("div",null,m.createElement("div",null,"Choose a geotiff or zip file to load as data layer"),m.createElement("input",{type:"file",accept:".zip,.geotiff,.tiff,.tif",onChange:e=>{console.log(e),o({tifFile:e.target.files[0]})}})),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Absolute Path and filename of file on mapserver"),m.createElement(f,{value:A,onChange:e=>o({filename:e.target.value})})),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Display Name"),m.createElement(f,{value:L,onChange:e=>o({displayname:e.target.value})})),m.createElement("div",{className:"mt-4"},m.createElement(N,{checked:"on"===M,onChange:e=>{o({mosaic:e.target.checked?"on":"off"})}},m.createElement("span",{className:"text-xs"},"Is this a zip containing images?"))),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full",onClick:()=>c()},"Upload"))))),m.createElement(E,null,m.createElement(_e,{header:"GeoRSS"},m.createElement("div",null,m.createElement("div",null,m.createElement("div",null,"GeoRSS URL"),m.createElement(f,{value:I,onChange:e=>{s({feedUrl:e.target.value})}})),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Display Name"),m.createElement(f,{value:D,onChange:e=>{s({displayname:e.target.value})}})),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Refresh Rate"),m.createElement("div",null,m.createElement(v,{value:R,style:{width:"100%"},onChange:e=>{s({refreshrate:e})}},m.createElement(Te,{value:"",disabled:!0},"Select"),m.createElement(Te,{value:"0"},"0.00"),m.createElement(Te,{value:"30"},"0.30"),m.createElement(Te,{value:"60"},"1.00"),m.createElement(Te,{value:"90"},"1.30"),m.createElement(Te,{value:"180"},"3.00"),m.createElement(Te,{value:"300"},"5.00")))),m.createElement("div",{className:"mt-4"},m.createElement(y,{type:"primary",className:"w-full",onClick:()=>{l()}},"Upload"))))),m.createElement(w,{title:`${Ie[b]} Data Sources`,visible:u,onOk:()=>C(!0),okText:"Import",onCancel:()=>C(!1)},m.createElement("div",null,m.createElement("div",{className:"flex items-center"},m.createElement("div",null,"Layer to Import"),m.createElement("div",{className:"ml-2"},m.createElement(v,{value:"",style:{width:120},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"flex items-center mt-4"},m.createElement("div",null,"Display Name"),m.createElement("div",{className:"ml-2"},m.createElement(f,null))),m.createElement("div",{className:"flex items-center mt-4"},m.createElement("div",null,"Legend"),m.createElement("div",{className:"ml-2"},m.createElement(f,null))),m.createElement("div",{className:"flex items-center mt-4"},m.createElement("div",null,"Refresh Rate"),m.createElement("div",{className:"ml-2"},m.createElement(v,{value:"",style:{width:120},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select"),m.createElement(Te,{value:"0"},"0.00"),m.createElement(Te,{value:"30"},"0.30"),m.createElement(Te,{value:"60"},"1.00"),m.createElement(Te,{value:"90"},"1.30"),m.createElement(Te,{value:"180"},"3.00"),m.createElement(Te,{value:"300"},"5.00")))),m.createElement("div",{className:"flex items-center mt-4"},m.createElement("div",null,"Restrict to organization"),m.createElement("div",{className:"ml-2"},m.createElement(v,{value:"",style:{width:120},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))),m.createElement("div",{className:"flex items-center mt-4"},m.createElement("div",null,"Restrict to Room"),m.createElement("div",{className:"ml-2"},m.createElement(v,{value:"",style:{width:120},onChange:()=>console.log("oop")},m.createElement(Te,{value:"",disabled:!0},"Select")))))))}));const{Panel:Re}=E;var Ae=d((({reducer:e})=>({reducer:e})),{fetchFire:ve})((({reducer:e,fetchFire:t})=>{const{fire:a}=e;return p.exports.useEffect((()=>{t()}),[]),m.createElement(m.Fragment,null,a.folders.map((e=>m.createElement(E,{key:e.rootId},m.createElement(Re,{header:e.foldername,key:e.foldername},m.createElement("div",{className:"mb-4"},m.createElement(N,null,"Briceburg IR")))))),a.datalayerfolders.map((e=>m.createElement("div",{className:"mb-4"},m.createElement(N,{checked:!1},e.datalayer.displayname)))))}));const{Option:Le}=v,{TextArea:Me}=f;var Oe=d((({reducer:e})=>({reducer:e})),{fetchIncidentTree:()=>({[ie]:{endpoint:e=>`${pe}/incidents/${e.reducer.workspaceId}/getincidenttree?accessibleByUserId=${e.reducer.userDetails.userId}`,types:["____","FETCH_INCIDENT_TREE_SUCCESS","___"]}}),fetchRoom:(e,t)=>({[ie]:{endpoint:t=>`${pe}/collabroom/${e}?userId=${t.reducer.userDetails.userId}`,types:["____","FETCH_ROOMS_SUCCESS","___"],onSuccess:(e,a,n)=>n(xe(t))}}),fetchRoomFeatures:e=>({[ie]:{endpoint:t=>`${pe}/features/collabroom/${e}?userId=${t.reducer.userDetails.userId}`,types:["____","FETCH_ROOMS_SUCCESS","___"],onSuccess:(e,t,a)=>a(xe(name))}})})((({reducer:e,fetchIncidentTree:t,fetchRoom:a,fetchRoomFeatures:n})=>{const{incidents:{incidents:r}={},room:l}=e,[s,o]=p.exports.useState(""),[c,i]=p.exports.useState("");return p.exports.useEffect((()=>{t()}),[]),m.createElement(m.Fragment,null,"room"===s?m.createElement(m.Fragment,null," ",m.createElement("div",{className:"mt-8"},"Incident - ",c),m.createElement("div",{className:"mt-8"},"Rooms"),m.createElement("div",{style:{height:"80%",overflow:"scroll"},className:"pb-64"},m.createElement(C,{itemLayout:"horizontal",dataSource:l.results,renderItem:e=>m.createElement(C.Item,{onClick:()=>{n(e.collabRoomId),alert("integrate this in openlayer")},className:"cursor-pointer hover:bg-blue-100"},m.createElement(C.Item.Meta,{title:m.createElement("div",null,e.name)}))}))):null,"create"===s?m.createElement(m.Fragment,null,m.createElement("div",{className:"flex items-center"},m.createElement("div",null,m.createElement("div",null,"Country"),m.createElement(v,{defaultValue:"lucy",style:{width:140}},m.createElement(Le,{value:"jack"},"Jack"),m.createElement(Le,{value:"lucy"},"Lucy"),m.createElement(Le,{value:"Yiminghe"},"yiminghe"))),m.createElement("div",{className:"ml-8"},m.createElement("div",null,"State"),m.createElement(v,{defaultValue:"lucy",style:{width:140}},m.createElement(Le,{value:"jack"},"Jack"),m.createElement(Le,{value:"lucy"},"Lucy"),m.createElement(Le,{value:"Yiminghe"},"yiminghe")))),m.createElement("div",{className:"flex items-center mt-8"},m.createElement("div",null,m.createElement("div",null,"Latitude"),m.createElement(f,{style:{width:140}})),m.createElement("div",{className:"ml-8"},m.createElement("div",null,"Longitude"),m.createElement(f,{style:{width:140}}))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Prefix"),m.createElement("div",null,"QUALAPPS")),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Parent Incident (Optional)"),m.createElement("div",null,m.createElement(v,{defaultValue:"lucy",style:{width:310}},m.createElement(Le,{value:"jack"},"Jack"),m.createElement(Le,{value:"lucy"},"Lucy"),m.createElement(Le,{value:"Yiminghe"},"yiminghe")))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Name"),m.createElement("div",null,m.createElement(f,{style:{width:310}}))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Description"),m.createElement("div",null,m.createElement(Me,{rows:2,style:{width:310}}))),m.createElement("div",{className:"mt-4"},m.createElement("div",null,"Incident Types"),m.createElement("div",null,m.createElement(v,{mode:"multiple",allowClear:!0,defaultValue:"lucy",style:{width:310}},m.createElement(Le,{value:"jack"},"Jack"),m.createElement(Le,{value:"lucy"},"Lucy"),m.createElement(Le,{value:"Yiminghe"},"yiminghe"))))):null,s?null:m.createElement(m.Fragment,null," ",m.createElement("div",{className:"my-4"},m.createElement(y,{type:"primary",onClick:()=>o("create")},"Create New Incident")),m.createElement("div",{className:"mb-2"},"Favorites"),m.createElement("div",{style:{height:"20%",overflow:"scroll"},className:""},m.createElement(C,{itemLayout:"horizontal",dataSource:[],renderItem:e=>m.createElement(C.Item,{onClick:()=>{i(e.incidentname),o("room"),a(e.incidentid)},className:"cursor-pointer hover:bg-blue-100"},m.createElement(C.Item.Meta,{title:m.createElement("div",null,e.incidentname)}))})),m.createElement("hr",null),m.createElement("div",{className:"mt-8"},"All Incidents"),m.createElement("div",{style:{height:"80%",overflow:"scroll"},className:"pb-64"},m.createElement(C,{itemLayout:"horizontal",dataSource:r,renderItem:e=>m.createElement(C.Item,{onClick:()=>{i(e.incidentname),o("room"),a(e.incidentid,e.incidentname)},className:"cursor-pointer hover:bg-blue-100"},m.createElement(C.Item.Meta,{title:m.createElement("div",{className:"text-xs"},e.incidentname)}))}))))}));var Pe=d((({reducer:e})=>({reducer:e})),{fetchMaps:()=>({[ie]:{endpoint:e=>`${pe}/folder/${e.reducer.workspaceId}/name/Maps`,types:["____","FETCH_MAPS_SUCCESS","___"],onSuccess:(e,t,a)=>{e.folders.forEach((e=>{a(Ce("maps",e.folderid))}))}}})})((({reducer:e,fetchMaps:t})=>{const{maps:a}=e;return p.exports.useEffect((()=>{t()}),[]),m.createElement(m.Fragment,null,a.folders.map((e=>m.createElement(Collapse,{key:e.rootId},m.createElement(Panel,{header:e.foldername,key:e.foldername},m.createElement("div",{className:"mb-4"},m.createElement(N,null,le.datalayer.displayname)))))),a.datalayerfolders.map((e=>m.createElement("div",{className:"mb-4"},m.createElement(N,{checked:!1},e.datalayer.displayname)))))}));const Fe=()=>m.createElement(m.Fragment,null,m.createElement("div",{className:"mb-4"},m.createElement(N,{defaultChecked:!0},"Bing Roads")),m.createElement("div",{className:"mb-4"},m.createElement(N,null,"Open Street Map")),m.createElement("div",{className:"mb-4"},m.createElement(N,null,"Bing Aerial")),m.createElement("div",{className:"mb-4"},m.createElement(N,null,"US Topo - 7.5 min quadrangle maps")),m.createElement("div",{className:"mb-4"},m.createElement(N,{defaultChecked:!0},"Bing Aerial with labels")),m.createElement("div",{className:"mb-4"},m.createElement(N,null,"FAA - Sectional Aeronautical Charts"))),{Panel:Ue}=E;var je=d((({reducer:e})=>({reducer:e})),{fetchTracking:we})((({reducer:e,fetchTracking:t})=>{const{tracking:a}=e;return p.exports.useEffect((()=>{t()}),[]),m.createElement(m.Fragment,null,a.folders.map((e=>m.createElement(E,{key:e.rootId},m.createElement(Ue,{header:e.foldername,key:e.foldername},m.createElement("div",{className:"mb-4"},m.createElement(N,null,"Briceburg IR")))))),a.datalayerfolders.map((e=>m.createElement("div",{className:"mb-4"},m.createElement(N,{checked:!1},e.datalayer.displayname)))))}));var He=d((({reducer:e})=>({reducer:e})),{fetchWeather:Ne,fetchFolderData:Ce})((({reducer:e,fetchWeather:t,fetchFolderData:a})=>(p.exports.useEffect((()=>{t()}),[]),m.createElement(m.Fragment,null,m.createElement(Tree,{className:"draggable-tree",draggable:!0,blockNode:!0,treeData:(void 0).state.gData})))));const{TreeNode:$e}=b,{Search:Ge}=f,{Option:ze}=v;class Be extends p.exports.Component{constructor(){super(...arguments),i(this,"state",{expandedKeys:[],searchValue:"",autoExpandParent:!0,visible:!1,selectedValue:"off"}),i(this,"getParentKey",((e,t)=>{let a;for(let n=0;n<t.length;n++){const r=t[n];r.children&&(r.children.some((t=>t.key===e))?a=r.key:this.getParentKey(e,r.children)&&(a=this.getParentKey(e,r.children)))}return a})),i(this,"gData",[]),i(this,"onDragEnter",(e=>{})),i(this,"onDrop",(e=>{const{layers:t}=this.props.reducer,a=e.node.key,n=e.dragNode.key,r=e.node.pos.split("-"),l=e.dropPosition-Number(r[r.length-1]),s=(e,t,a)=>{for(let n=0;n<e.length;n++){if(e[n].key===t)return a(e[n],n,e);e[n].children&&s(e[n].children,t,a)}},o=[...t];let c;if(s(o,n,((e,t,a)=>{a.splice(t,1),c=e})),e.dropToGap)if((e.node.props.children||[]).length>0&&e.node.props.expanded&&1===l)s(o,a,(e=>{e.children=e.children||[],e.children.unshift(c)}));else{let e,t;s(o,a,((a,n,r)=>{e=r,t=n})),-1===l?e.splice(t,0,c):e.splice(t+1,0,c)}else s(o,a,(e=>{e.children=e.children||[],e.children.unshift(c)}));this.props.updateLayer(o)})),i(this,"renderTree",(e=>{const{searchValue:t}=this.state,{featureLayers:a}=this.props.reducer,n=e=>{const a=e.indexOf(t);e.substr(0,a),e.substr(a+t.length);if(e)return e};return e.map(((e,t)=>{if(!e.link)return m.createElement($e,{title:n(e.title),key:e.key,dataRef:e,checkable:!1},e.children&&e.children.length?this.renderTree(e.children):null);if(a.length){const t=a.filter((t=>t.key===e.key));t.length&&t[0].checked}return m.createElement($e,{checkable:!0,title:m.createElement("div",{className:"truncate",style:{width:"120px"},title:e.title},n(e.title)),key:e.key,dataRef:e})}))})),i(this,"onExpand",(e=>{this.setState({expandedKeys:e,autoExpandParent:!1})})),i(this,"onChange",(e=>{const{layers:t,featureLayers:a,mapLayer:n}=this.props.reducer,{value:r}=e.target;a.map((e=>e.title.toLowerCase().indexOf(r.toLowerCase())>-1?this.getParentKey(e.key,t):null)).filter(((e,t,a)=>e&&a.indexOf(e)===t)),this.setState({searchValue:r})}))}componentDidMount(){const{apiCalls:e}=this.props.reducer;e&&(this.props.fetchFire(),this.props.fetchWeather(),this.props.fetchTracking(),this.props.fetchData())}render(){const{layers:e,mapLayer:t,featureLayers:a}=this.props.reducer,{searchValue:n,expandedKeys:r,autoExpandParent:l,selectedValue:s}=this.state;return m.createElement(m.Fragment,null,m.createElement("div",{className:"mt-4 flex justify-between items-center"},m.createElement("div",{className:"text-bg-gray-800 font-semibold"},"Sort:"),m.createElement("div",{className:""},m.createElement(v,{defaultValue:s,style:{width:200},onChange:e=>{this.setState({selectedValue:e})}},m.createElement(ze,{value:"off"},"Off"),m.createElement(ze,{value:"ascending"},"Ascending (A-Z)")))),m.createElement("div",{className:"mt-4"},m.createElement(Ge,{style:{marginBottom:8},placeholder:"Search",onChange:this.onChange})),m.createElement("div",{className:"py-2"},m.createElement(b,{className:"draggable-tree py-4",draggable:!0,checkable:!0,blockNode:!0,onRightClick:e=>{if(!this.state.visible){var t=this;document.addEventListener("click",(function e(){t.setState({visible:!1}),t.props.handleRightClick({pageX:"",pageY:"",key:"",opacity:1}),document.removeEventListener("click",e)}))}this.setState({visible:!0}),this.props.handleRightClick({pageX:e.event.pageX,pageY:e.event.pageY,key:e.node.key,opacity:e.node.opacity})},onCheck:(e,t)=>{console.log(e,t),this.props.handleLayerCheck(t.node.key,t.checked,"checked")},onExpand:this.onExpand,expandedKeys:r,autoExpandParent:l,onDragEnter:this.onDragEnter,onDrop:this.onDrop},this.renderTree(n||"off"!==s?a.filter((e=>e.title.toLowerCase().includes(n.toLowerCase()))).sort((function(e,t){return e.title<t.title?-1:e.title>t.title?1:0})):e))))}}var Je=d((({reducer:e})=>({reducer:e})),{updateLayer:e=>({type:"UPDATE_LAYER",data:e}),fetchFire:ve,fetchWeather:Ne,fetchTracking:we,fetchData:()=>({[ie]:{endpoint:e=>`${pe}/folder/${e.reducer.workspaceId}/name/Data`,types:["____","FETCH_DATA_SUCCESS","___"],onSuccess:(e,t,a)=>{e.folders.forEach((e=>{a(Ce("data",e.folderid))}))}}}),handleLayerCheck:Se,handleRightClick:e=>({type:"HANDLE_RIGHT_CLICK_NODE",obj:e})})(Be);var qe=new class{constructor(e){this.invalidInput="Invalid Input",this.safeString=new RegExp("[a-zA-Z0-9&_ !,@#$%*()?{}+-\\/';:\"|]*"),this.logPrefix="IWEB - "}matchSafeString(e){if(""!=e){var t=e.match(this.safeString);return 1!=t.length||""==t[0]||t[0]!=e?this.invalidInput:t[0]}return e}getValidInput(e){for(var t=(e+"").split("\n"),a=0;a<t.length;a++)if(this.matchSafeString(t[a])===this.invalidInput)return this.invalidInput;return e}isValidInput(e){return this.getValidInput(e)!=this.invalidInput}getBrowserVersion(){if(navigator&&navigator.userAgent){var e=navigator.userAgent;return e=e.toLowerCase(),(/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[])[1]||""}return""}getUTCTimestamp(){var e=new Date;return e.getUTCFullYear()+"-"+this.pad(e.getUTCMonth()+1)+"-"+this.pad(e.getUTCDate())+" "+this.pad(e.getUTCHours())+":"+this.pad(e.getUTCMinutes())+":"+this.pad(e.getUTCSeconds())}getUTCTimestampZ(){var e=this.getUTCTimestamp();return e=e.replace(" ","T"),e+="Z"}pad(e){var t=e+"";return 1===t.length?"0".concat(t):t}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})).toUpperCase()}validateInterface(e,t){for(var a in e)if(t[a])return!1;return!0}splitDate(e){var t,a,n,r,l,s;try{return t=(e=e.split("-"))[0],a=e[1]-1,n=(e=e[2].split(" "))[0],r=(e=e[1].split(":"))[0],l=e[1],s=(e=e[2].split("."))[0],new Date(t,a,n,r,l,s)}catch(o){return new Date}}formatDateToString(e){return e.getFullYear()+"-"+this.pad(e.getMonth()+1)+"-"+this.pad(e.getDate())+" "+this.pad(e.getHours()+":"+this.pad(e.getMinutes())+":"+this.pad(e.getSeconds()))}},Ke=function(){var e={};function t(t){var a,n=t&&e[t];return n||(n={publish:(a=x.Callbacks()).fire,subscribe:a.add,unsubscribe:a.remove},t&&(e[t]=n)),n}return{fireEvent:function(e,a){var n=t(e);n.publish.apply(n,arguments)},addListener:function(e,a){t(e).subscribe(a)},removeListener:function(e,a){t(e).unsubscribe(a)},createCallbackHandler:function(e,t,a,n){var r=function(l,s){n||(n=[]),n.push(l),n.push(s),a.apply(t,n),this.removeListener(e,r)}.bind(this);this.addListener(e,r)}}}(),Ve=function(){var e=null,t=18e4,a=3e4,n=0,r=null,l=null,s=null,o=[],c=!1,i=!1,d=null,m=-1,u=(new Date).getTime(),p=!1,E=null,y="info",h=[],g=new Map;function f(){}function v(){}var N=new v;return v.prototype.log=function(e){console.log(`${new Date} ${e}`)},f.prototype.doesConnectionExist=function(){var e=new XMLHttpRequest;e.addEventListener("readystatechange",(function(t){4==e.readyState&&(e.status>=200&&e.status<304?(Ke.fireEvent("iweb.connection.reconnected",(new Date).getTime()),N.log("Mediator doesConnectionExist determined connection alive... "),n=0):(i=!1,++n>=3&&(N.log("Mediator doesConnectionExist determined connection lost... "),Ke.fireEvent("iweb.connection.disconnected"))))}),!0);var t=Math.round(1e4*Math.random());e.open("HEAD","/.well-known/host-meta.json?rand="+t,!0),e.timeout=1e4,e.send()},f.prototype.keepTokenAlive=function(){let e="/em-api/v1/snoop/oidc_access_token_expires?"+x.param({rand:Math.round(1e4*Math.random())});x.ajax({type:"GET",dataType:"text",contentType:"application/json",url:e,headers:{"Content-Type":"application/json"},success:function(e,t,a){const n=JSON.parse(a.responseText).headers.oidc_access_token_expires;localStorage.setItem("oidc_access_token_expires",n)},error:function(e,t,a){alert("Request failed.  Returned status of "+status)}})},f.prototype.setTimeOfDisconnect=function(e){d=e},f.prototype.sendCache=function(){h.forEach((function(t){i&&(N.log("Mediator processing message from featureCache "+JSON.stringify(t)),delete t.payload.jsonData.internal,x.ajax(e.attachHandlers({type:t.payload.method,dataType:"text",contentType:t.payload.contentType,data:JSON.stringify(t.payload.jsonData),url:t.payload.url,headers:t.payload.headers},t.eventName)))})),g.forEach((function(t,a){i&&(N.log("Mediator processing message from chatCache "+JSON.stringify(t)),x.ajax(e.attachHandlers({type:t.payload.method,dataType:"text",contentType:t.payload.contentType,data:t.payload,url:t.payload.url,headers:t.payload.headers},a)))}))},f.prototype.onReconnect=function(){if(N.log("Mediator onReconnect prototype called with socketConnected "+i+" timeOfDisconnect "+d),this.sendCache(),null!=d||(new Date).getTime()-u>a){N.log("Mediator firing reconnect event from onReconnect");for(var e=0;e<o.length;e++)N.log("Mediator Resubscribing to topic ::"+o[e]),this.subscribe(o[e]);Ke.fireEvent("iweb.connection.reconnected",d),this.setTimeOfDisconnect(null)}u=(new Date).getTime()},f.prototype.onReopen=function(){if(N.log("Mediator onReopen prototype called with socketConnected "+i),i){for(var e=0;e<o.length;e++)this.subscribe(o[e]);N.log("Mediator firing reconnect event from onReopen"),null!=d?(Ke.fireEvent("iweb.connection.reconnected",d),this.setTimeOfDisconnect(null)):Ke.fireEvent("iweb.connection.reconnected",(new Date).getTime())}},f.prototype.onDisconnect=function(){this.setTimeOfDisconnect((new Date).getTime())},f.prototype.close=function(){S.unsubscribe()},f.prototype.setRestAPI=function(e){this.restApiUrl=e},f.prototype.getRestAPI=function(){return this.restApiUrl},f.prototype.updateFeatureCache=function(e){switch(e.payload.jsonData.internal.action){case"delete":h=h.filter((function(t){return e.payload.jsonData.featureId?!t.payload.jsonData.featureId||e.payload.jsonData.featureId!==t.payload.jsonData.featureId:!!t.payload.jsonData.featureId||e.payload.jsonData.internal.ol_uid!==t.payload.jsonData.internal.ol_uid})),e.payload.jsonData.featureId&&h.push(e);break;case"change":var t=!1;h.forEach((function(a){e.payload.jsonData.featureId&&a.payload.jsonData.featureId&&e.payload.jsonData.featureId===a.payload.jsonData.featureId&&(a.payload.jsonData=e.payload.jsonData,t=!0),!e.payload.jsonData.featureId&&a.payload.jsonData.internal.ol_uid&&e.payload.jsonData.internal.ol_uid===a.payload.jsonData.internal.ol_uid&&(a.payload.jsonData=e.payload.jsonData,t=!0)})),t||h.push(e);break;case"new":h.push(e)}},f.prototype.deleteFeatureCache=function(e){h=h.filter((function(t){return t.eventName!==e.eventName}))},f.prototype.updateChatCache=function(e){if(null!=e.payload){var t=e.payload;null!=t.jsonData.chatid&&(g.forEach((function(e,a){e.payload.jsonData.chatid==t.jsonData.chatid&&g.delete(a)})),g.set(e.eventName,e))}},f.prototype.deleteChatCache=function(e){g.delete(e.eventName)},f.prototype.sendMessage=function(e){if(e){var t=qe.generateUUID();p&&Ke.fireEvent("iweb.logger.log.debug",["Attaching client-side requestId to message: ",t,e]),e.requestId=t}return null!=e.eventName&&((e.eventName.indexOf("nics.collabroom.feature.create")>=0||e.eventName.indexOf("nics.collabroom.feature.change")>=0||e.eventName.indexOf("nics.collabroom.feature.delete")>=0)&&this.updateFeatureCache(e),e.eventName.indexOf("chat.proxy.")>=0&&this.updateChatCache(e)),!!i&&(r.request.isReopen||r.push(JSON.stringify(e)),!0)},f.prototype.publishMessage=function(e,t){this.sendMessage({type:"publish",message:JSON.stringify(t),topic:e})},f.prototype.subscribe=function(e){-1==x.inArray(e,o)&&o.push(e),this.sendMessage({type:"subscribe",topic:e})},f.prototype.unsubscribe=function(e){var t=x.inArray(e,o);-1!=t&&o.splice(t,1),this.sendMessage({type:"unsubscribe",topic:e})},f.prototype.handleSuccessResponse=function(t,a){try{if(a.responseText){if(-1!==a.responseText.indexOf("Log in to")&&-1!==a.responseText.indexOf("scout-logo"))return void Ke.fireEvent("onLogoutOfOIDCSession");var n=JSON.parse(a.responseText);n&&Ke.fireEvent(t,n),n.eventName=t,null!=n.eventName&&((n.eventName.indexOf("nics.collabroom.feature.create")>=0||n.eventName.indexOf("nics.collabroom.feature.change")>=0||n.eventName.indexOf("nics.collabroom.feature.delete")>=0||n.eventName.indexOf("iweb.messageTest")>=0)&&e.deleteFeatureCache(n),n.eventName.indexOf("chat.proxy.")>=0&&e.deleteChatCache(n))}else Ke.fireEvent(t,a.responseText)}catch(r){Ke.fireEvent(t,a.responseText)}},f.prototype.handleFailureResponse=function(e,t){try{var a=JSON.parse(t.responseText);a&&Ke.fireEvent(e,a)}catch(n){Ke.fireEvent(e,t.responseText)}},f.prototype.attachHandlers=function(t,a){return t.success=function(t,n,r){e.handleSuccessResponse(a,r)},t.error=function(t,n,r){e.handleFailureResponse(a,r)},t},f.prototype.sendDeleteMessage=function(e,t,a){var n={eventName:t,payload:{url:e,method:"DELETE",headers:{"Content-Type":"application/json",requestid:qe.generateUUID()}}};x.ajax(this.attachHandlers({type:n.payload.method,dataType:"text",url:n.payload.url,headers:n.payload.headers},t))},f.prototype.sendPutMessage=function(e,t,a,n){var r={url:e,method:"PUT",dataType:"text",contentType:"application/json",jsonData:a,headers:{"Content-Type":"application/json",requestid:qe.generateUUID()}},l={eventName:t,payload:r};if(n&&!n.indexOf("json")||(r.headers={"Content-Type":"application/json"}),i)try{x.ajax(this.attachHandlers({type:l.payload.method,dataType:"text",contentType:l.payload.contentType,data:JSON.stringify(l.payload.jsonData),url:l.payload.url,headers:l.payload.headers},t))}catch(s){console.log("Error in attaching request handlers")}},f.prototype.sendPostMessage=function(e,t,a,n){var r={url:e,method:"POST",dataType:"text",contentType:"application/json",jsonData:a,headers:{"Content-Type":"application/json",requestid:qe.generateUUID()}};n&&!n.indexOf("json")||(r.headers={"Content-Type":"application/json"});var l={eventName:t,payload:r};N.log(" Mediator sendPostMessage "+JSON.stringify(l)+" with  socketConnected "+i);let s=!0;if(null!=l.eventName&&((l.eventName.indexOf("nics.collabroom.feature.create")>=0||l.eventName.indexOf("nics.collabroom.feature.change")>=0||l.eventName.indexOf("nics.collabroom.feature.delete")>=0||l.eventName.indexOf("iweb.messageTest")>=0)&&(l.eventName.indexOf("iweb.messageTest.new")>=0&&(l.payload.jsonData.internal.action="new"),this.updateFeatureCache(l),s=h.length>0),l.eventName.indexOf("chat.proxy.")>=0&&this.updateChatCache(l)),i&&s&&s){r.data&&delete r.data.internal;try{x.ajax(this.attachHandlers({type:l.payload.method,dataType:"text",contentType:l.payload.contentType,data:JSON.stringify(l.payload.jsonData),url:l.payload.url,headers:l.payload.headers},t))}catch(o){console.log("Error in attaching request handlers")}}},f.prototype.sendRequestMessage=function(e,t,a){var n={url:e,method:"GET"},r={eventName:t,payload:n};N.log("Mediator onOpen initiated with request "+n),x.ajax(this.attachHandlers({type:r.payload.method,dataType:"text",url:r.payload.url,headers:r.payload.headers},t))},f.prototype.setSessionId=function(e){l=e},f.prototype.getSessionId=function(){return l},f.prototype.setReinitalizeUrl=function(e){r.request.url=e},f.prototype.setCurrentUserSessionId=function(e){s=e},f.prototype.getCurrentUserSessionId=function(){return s},{initialize:function(l,s){!function(l){Ke.addListener("iweb.config.loaded",(function(e,t){if((E=t)&&E.logging&&E.logging.request&&"true"===E.logging.request?(Ke.fireEvent("iweb.logger.log.debug",["Setting requestLogging to: "+E.logging.request]),p=!0):p=!1,x.ajaxSetup({beforeSend:function(e){console.dir(e),e.withCredentials=!0}}),E.atmosphere)try{y=E.atmosphere.logging.level,Ke.fireEvent("iweb.logger.log.info",["Set logging level to: "+y])}catch(a){Ke.fireEvent("iweb.logger.log.warn",["Config file missing property: atmosphere.logging.level. Setting to default of 'info'"]),y="info"}})),e=new f;var s=S,o={url:"mediator",contentType:"application/json",logLevel:y,transport:"websocket",trackMessageLength:!0,reconnectInterval:5e3,fallbackTransport:"long-polling",maxReconnectOnClose:17280,closeAsync:!0,onOpen:function(){i=!0,c?(N.log("Mediator onOpen reconnection with socketConnected "+i),e.onReconnect()):(e.setTimeOfDisconnect(null),c=!0,l&&e.subscribe(l),N.log("Mediator onOpen initiated with socketConnected "+i),e.sendMessage({type:"config"}))},onError:function(t){t.status&&"WebSocket instantiation failed"==t.status?Ke.fireEvent("onWebSocketInstantiationFailed"):e.onDisconnect()},onClose:function(t){i=!1,N.log("Mediator onClose called  with socketConnected "+i),void 0===t.messageCode||1e3!=t.messageCode?(N.log("Mediator signalling disconnect..."),e.onDisconnect()):e.doesConnectionExist()},onClientTimeout:function(e){N.log("Mediator onClientTimeout will initiate reconnection after reconnectionInterval..."),setTimeout((function(){r=s.subscribe(o)}),o.reconnectInterval)},onReconnect:function(){N.log("Mediator onReconnect called with socketConnected "+i),i=!0,e.onReconnect()},onReopen:function(){i=!0,e.doesConnectionExist(),N.log("Mediator onReopen called with socketConnected "+i),e.onReopen()}},d=function(t){var a=t.responseBody;if(a&&""!==a){if(-1!==a.indexOf("Log in to")&&-1!==a.indexOf("scout-logo"))return Ke.fireEvent("onLogout"),void e.close();var n=JSON.parse(a);if(N.log("Atmosphere Received with message::"+JSON.stringify(n)),p&&Ke.fireEvent("iweb.logger.log.debug",[String.format("!!! Response with requestId: {0}",n.requestId),n]),null!=n.data){if("json"==n.responseType)try{n.data=JSON.parse(n.data)}catch(r){Ke.fireEvent("iweb.logger.log.error",["Exception parsing incoming message.data to JSON",r])}Ke.fireEvent(n.eventName,n.data)}else n.errorMessage&&alert("Error",n.errorMessage)}};o.onMessage=d,o.onMessagePublished=d,s&&(r=s.subscribe(o)),window.setTimeout((function t(){e.doesConnectionExist(),window.setTimeout(t,2e4)}),2e4),window.setTimeout((function t(){m<0&&(m=(new Date).getTime()),i&&(Ke.fireEvent("iweb.connection.periodicUpdate",m),m=(new Date).getTime()),N.log("Mediator Periodic update timeOfLastUpdate updated to "+m),(new Date).getTime()-u>6e4&&e.onReconnect(),window.setTimeout(t,a)}),a),e.keepTokenAlive(),window.setTimeout((function a(){e.keepTokenAlive(),window.setTimeout(a,t)}),t),window.addEventListener("online",(function(){n=0,N.log("Mediator windows event signalling connection alive... "),Ke.fireEvent("iweb.connection.reconnected",(new Date).getTime())})),window.addEventListener("offline",(function(){N.log("Mediator windows event signalling connection lost... "),i=!1,e.onDisconnect()}))}(l)},getInstance:function(){if(console.log("GetInstance"),console.dir(e),e)return e}}}();class We extends p.exports.Component{constructor(e){super(e),this.testGetMethodBinding=this.getMethodResonseFromEMAPI.bind(this),Ke.addListener("iweb.messageTest.get",this.testGetMethodBinding),this.testPostMethodBinding=this.postMethodResponseFromEMAPI.bind(this),Ke.addListener("iweb.messageTest.new",this.testPostMethodBinding),Ve.getInstance().subscribe("iweb.messageTest.new"),this.testPutMethodBinding=this.putMethodResponseFromEMAPI.bind(this),Ke.addListener("iweb.messageTest.update",this.testPutMethodBinding),this.testDeletetMethodBinding=this.deleteMethodResponseFromEMAPI.bind(this),Ke.addListener("iweb.messageTest.delete",this.testDeletetMethodBinding)}invokeGet(){if(confirm("Press a button: GET!")){let e=`${pe}/messageTest/success/ASHOK`;const t="iweb.messageTest.get";Ve.getInstance().subscribe(t),Ve.getInstance().sendRequestMessage(e,t)}else alert("You pressed Cancel!")}getMethodResonseFromEMAPI(e,t){console.log("GET Method from EMAPI :: "+JSON.stringify(t)),alert("Message Received - GET Method :: EventName \n"+e+"\n Response:: "+JSON.stringify(t))}invokePost(){if(confirm("Press a button : POST!")){let e=`${pe}/messageTest/success`,t={userName:"ashok",userId:"userid",test:"test",internal:{}};Ve.getInstance().subscribe("iweb.messageTest.new"),Ve.getInstance().sendPostMessage(e,"iweb.messageTest.new",t)}else alert("You pressed Cancel!")}postMethodResponseFromEMAPI(e,t){console.log("POST Method from EMAPI :: "+JSON.stringify(t)),alert("Message Received - POST Method :: EventName \n"+e+"\n Response:: "+JSON.stringify(t))}invokePut(){if(confirm("Press a button : PUT!")){let e=`${pe}/messageTest/success/ID`,t={userName:"ashok",userId:"userid",test:"test",internal:{}};Ve.getInstance().sendPutMessage(e,"iweb.messageTest.update",t)}else alert("You pressed Cancel!")}putMethodResponseFromEMAPI(e,t){console.log("PUT Method from EMAPI :: "+JSON.stringify(t)),alert("Message Received - PUT Method :: EventName \n"+e+"\n Response:: "+JSON.stringify(t))}invokeDelete(){if(confirm("Press a button : DELETE!")){let e=`${pe}/messageTest/success/ID`;Ve.getInstance().sendDeleteMessage(e,"iweb.messageTest.delete")}else alert("You pressed Cancel!")}deleteMethodResponseFromEMAPI(e,t){console.log("DELETE Method from EMAPI :: "+JSON.stringify(t)),alert("Message Received - DELETE Method :: EventName \n"+e+"\n Response:: "+JSON.stringify(t))}render(){return m.createElement(m.Fragment,null,m.createElement("div",{className:"my-4"},m.createElement(y,{type:"primary",onClick:this.invokeGet},"GET")),m.createElement("div",{className:"my-4"},m.createElement(y,{type:"primary",onClick:this.invokePost},"POST")),m.createElement("div",{className:"my-4"},m.createElement(y,{type:"primary",onClick:this.invokePut},"PUT")),m.createElement("div",{className:"my-4"},m.createElement(y,{type:"primary",onClick:this.invokeDelete},"DELETE")))}}var Ye=d((({reducer:e})=>({reducer:e})),{})((({closeMenu:e,reducer:t})=>{const[a,n]=p.exports.useState(""),[r,l]=p.exports.useState(!1),{user:{email:s}={}}=t;return m.createElement("div",{className:"fixed left-0 bottom-0 w-1/5 px-2 py-4 z-20 overflow-y-scroll",style:{backgroundColor:"#d9e6f4",top:"54px"}},a?null:m.createElement("div",null,m.createElement("div",{className:"flex justify-between items-center mt-0"},m.createElement("div",{className:"flex items-center"},a?m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/2223/2223615.png",className:"w-3 h-3 cursor-pointer mr-4",onClick:()=>n("")}):null,m.createElement("div",{className:"text-gray-800 font-bold text-md"},"Favorites")),a?null:m.createElement("div",{className:"font-bold cursor-pointer p-2 rounded",onClick:e},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/1828/1828778.png",width:15}))),m.createElement("div",{className:"text-gray-600"},"No Favorites")),m.createElement("div",{className:"flex justify-between items-center mt-8"},m.createElement("div",{className:"flex items-center"},a?m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/2223/2223615.png",className:"w-3 h-3 cursor-pointer mr-4",onClick:()=>n("")}):null,m.createElement("div",{className:"text-gray-800 font-bold text-md"},a||"All Apps")),a?m.createElement("div",{className:"font-bold cursor-pointer p-2 rounded",onClick:e},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/1828/1828778.png",width:15})):null),a?null:m.createElement("div",{className:"flex flex-wrap justify-between mt-4"},m.createElement("div",{className:"w-3/10 mx-auto flex items-center justify-center flex-col bg-gray-50 rounded hover:shadow p-4 hover:bg-gray--100 cursor-pointer mb-4",onClick:()=>n("BaseMap")},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/684/684908.png",width:20}),m.createElement("div",{className:"mt-2 font-semibold text-xs"},"BaseMap")),m.createElement("div",{className:"w-3/10 mx-auto flex items-center justify-center flex-col bg-gray-50 rounded hover:shadow p-4 hover:bg-gray--100 cursor-pointer mb-4",onClick:()=>n("Workspace")},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/201/201559.png",width:20}),m.createElement("div",{className:"mt-2 font-semibold text-center text-xs"},"Workspace")),m.createElement("div",{className:"w-3/10 mx-auto flex items-center justify-center flex-col bg-gray-50 rounded hover:shadow p-4 hover:bg-gray--100 cursor-pointer mb-4",onClick:()=>n("Incidents")},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/595/595067.png",width:20}),m.createElement("div",{className:"mt-2 font-semibold text-center text-xs"},"Incidents")),m.createElement("div",{className:"w-3/10 flex items-center justify-center flex-col bg-gray-50 rounded hover:shadow p-4 hover:bg-gray--100 cursor-pointer mb-4",onClick:()=>n("Layers")},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/802/802033.png",width:20}),m.createElement("div",{className:"mt-2 font-semibold text-center text-xs"},"Layers")),m.createElement("div",{className:"w-3/10 mx-auto flex items-center justify-center flex-col bg-gray-50 rounded hover:shadow p-4 hover:bg-gray--100 cursor-pointer mb-4",onClick:()=>n("Fire")},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/785/785116.png",width:20}),m.createElement("div",{className:"mt-2 font-semibold text-center text-xs"},"Fire")),m.createElement("div",{className:"w-3/10 mx-auto flex items-center justify-center flex-col bg-gray-50 rounded hover:shadow p-4 hover:bg-gray--100 cursor-pointer mb-4",onClick:()=>n("Data")},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/1849/1849515.png",width:20}),m.createElement("div",{className:"mt-2 font-semibold text-center text-xs"},"Data")),m.createElement("div",{className:"w-3/10 mx-auto flex items-center justify-center flex-col bg-gray-50 rounded hover:shadow p-4 hover:bg-gray--100 cursor-pointer mb-4",onClick:()=>n("TestMediator")},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/1849/1849515.png",width:20}),m.createElement("div",{className:"mt-2 font-semibold text-center text-xs"},"TestMediator")),m.createElement("div",{className:"fixed bottom-0 left-0 z-20 w-1/5 pb-4 shadow-lg bg-white"},r?m.createElement("div",{className:"p-8"},m.createElement("div",{className:"p-2 bg-white"},"Account Information"),m.createElement("div",{className:"p-2 bg-white"},"Help"),m.createElement("div",{className:"p-2 bg-white"},"Contact Us"),m.createElement("div",{className:"p-2 bg-white"},"About"),m.createElement("div",{className:"p-2 bg-white"},"Logout")):null,m.createElement(k,{style:{marginTop:0}}),m.createElement("div",{className:"flex justify-around items-center"},m.createElement("div",null,s),m.createElement("div",{onClick:()=>l(!r),className:"cursor-pointer"},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/271/271239.png",width:12}))))),"BaseMap"===a?m.createElement(Pe,null):null,"Fire"===a?m.createElement(Ae,null):null,"Weather"===a?m.createElement(He,null):null,"Tracking"===a?m.createElement(je,null):null,"Tools"===a?m.createElement(Fe,null):null,"Incidents"===a?m.createElement(Oe,null):null,"Data"===a?m.createElement(De,null):null,"Layers"===a?m.createElement(Je,null):null,"TestMediator"===a?m.createElement(We,null):null)}));var Xe=d((({reducer:e})=>({reducer:e})),{})((({closeMessageBox:e,reducer:t})=>{const[a,n]=p.exports.useState(!1);return m.createElement("div",{className:"w-64 h-96 p-2 rounded shadow",style:{background:"rgba(0,60,136,.5)"}},m.createElement("div",{className:"flex justify-between items-center"},m.createElement("div",{className:"text-white"},a?"Participants":"Messages"),m.createElement("div",{className:"flex items-center"},a?m.createElement("div",{className:"mr-4 cursor-pointer",onClick:()=>n(!1)},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/3721/3721843.png",width:20})):m.createElement("div",{className:"mr-4 cursor-pointer",onClick:()=>n(!0)},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/681/681494.png",width:20})),m.createElement("div",{onClick:e,className:"cursor-pointer"},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/32/32325.png",width:16})))),m.createElement(k,{style:{margin:"8px 0px"}}),a?null:m.createElement("div",{className:"absolute bottom-2 w-60 bg-white"},m.createElement(f,{placeholder:"Enter the message"})),a?m.createElement("div",null,m.createElement("div",{className:"bg-gray-100 p-1 pl-4 rounded"},"Sachin V"),m.createElement("div",{className:"mt-1 bg-gray-100 p-1 pl-4 rounded"},"Amaan M")):null)}));var Ze=d((({reducer:e})=>({reducer:e})),{handleMenu:e=>({type:"HANDLE_MENU_BAR",flag:e})})((({olmap:e,addInteraction:t,draw:a,selectFeature:n,removeFeature:r,addDrawInteraction:l,freeDraw:s,setFreeDraw:o,handleMenu:c})=>{const[i,d]=p.exports.useState(!1),[u,E]=p.exports.useState(!1),[y,h]=p.exports.useState(!1),[g,f]=p.exports.useState(!1),[v,N]=p.exports.useState(!1),[w,C]=p.exports.useState(!1);return m.createElement(m.Fragment,null,m.createElement("div",{className:"fixed",style:{bottom:"25px",right:"20px",zIndex:10}},m.createElement("a",{className:"cursor-pointer",onClick:()=>{d(!i)}},m.createElement("img",{src:i?"https://image.flaticon.com/icons/png/512/565/565655.png":"https://image.flaticon.com/icons/png/512/159/159604.png",width:50}))),i?m.createElement("div",{className:"fixed",style:{top:70,right:15,zIndex:10}},m.createElement("div",{className:"bell-playground"}),m.createElement("span",null,m.createElement("div",{style:{background:"#d3e1f1",padding:4,border:"2px solid #99bce8",borderRadius:4}},m.createElement("div",null,m.createElement("div",{className:"p-3 hover:bg-blue-100"},m.createElement("a",{className:"cursor-pointer",onClick:()=>{e.removeInteraction(a),n()}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/149/149852.png",width:25,className:"mx-auto"}))),m.createElement("div",{className:"p-3 hover:bg-blue-100"},m.createElement("a",{className:"cursor-pointer",onClick:()=>{e.removeInteraction(a),n()}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/2627/2627937.png",width:25,className:"mx-auto"}))),g?m.createElement("div",{className:"absolute rounded shadow-lg border-blue-300 border-2",style:{right:100}},m.createElement("div",{className:"absolute z-10",style:{right:"-10px",top:"-10px"}},m.createElement("span",{className:"text-red-400 font-bold cursor-pointer",onClick:()=>{t("None"),f(!1)}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/463/463612.png",width:24}))),m.createElement("div",{className:"bg-gray-200 p-2 h-24 w-24 rounded"},m.createElement("div",{className:"flex justify-around items-center my-1"},m.createElement("div",{className:"mt-1 p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),t("LineString")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/815/815497.png",width:24})),m.createElement("div",{className:"mt-1 p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),t("Circle")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/481/481078.png",width:24}))),m.createElement("div",{className:"flex justify-around items-center my-1"},m.createElement("div",{className:"mt-1 p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),t("Square")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/2627/2627937.png",width:24})),m.createElement("div",{className:"mt-1 p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),t("Box")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/33/33848.png",width:24}))))):null,m.createElement("div",{className:"p-3 hover:bg-blue-100 relative",onClick:()=>f(!g)},m.createElement("a",{className:"cursor-pointer"},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/815/815497.png",width:30,className:"mx-auto"}))),v?m.createElement("div",{className:"absolute rounded shadow-lg border-blue-300 border-2",style:{right:100}},m.createElement("div",{className:"absolute z-10",style:{right:"-10px",top:"-10px"}},m.createElement("span",{className:"text-red-400 font-bold cursor-pointer",onClick:()=>{l("None"),N(!1)}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/463/463612.png",width:24}))),m.createElement("div",{className:"bg-gray-200 p-2 h-24 w-24 rounded"},m.createElement("div",{className:"flex justify-around items-center my-1 "},m.createElement("div",{className:"mt-1 p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),l("LineString")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/815/815497.png",width:24})),m.createElement("div",{className:"p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),l("Circle")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/481/481078.png",width:24}))),m.createElement("div",{className:"flex justify-around items-center my-1"},m.createElement("div",{className:"p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),l("Square")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/2627/2627937.png",width:24})),m.createElement("div",{className:"p-1 w-2/5 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),l("Box")}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/33/33848.png",width:24}))))):null,m.createElement("div",{className:s?"p-3 relative bg-blue-100":"p-3 hover:bg-blue-100 relative",onClick:()=>{f(!g),o(!s)}},m.createElement("a",{className:"cursor-pointer"},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/598/598234.png",width:30,className:"mx-auto"}))),m.createElement("div",{className:"p-3 hover:bg-blue-100",onClick:()=>{e.removeInteraction(a),r()}},m.createElement("a",{className:"cursor-pointer"},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/43/43279.png",width:30,className:"mx-auto"}))),m.createElement("div",{className:"mb-2 mt-4",style:{borderTop:"1px solid black"}}),w?m.createElement("div",{className:"absolute rounded shadow-lg border-blue-300 border-2",style:{right:100}},m.createElement("div",{className:"absolute z-10",style:{right:"-10px",top:"-10px"}},m.createElement("span",{className:"text-red-400 font-bold cursor-pointer",onClick:()=>{l("None"),C(!1)}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/463/463612.png",width:24}))),m.createElement("div",{className:"bg-gray-200 p-2 h-30 w-24 rounded"},m.createElement("div",{className:"flex"},m.createElement("div",{className:"p-1 hover:bg-gray-50 cursor-pointer",onClick:()=>{e.removeInteraction(a),t("add")}},m.createElement("img",{src:"https://www.nwcg.gov/sites/default/files/publications/images/936-point-branch-break.jpg",width:24}))))):null,m.createElement("div",{className:"p-3 hover:bg-blue-100"},m.createElement("a",{className:"cursor-pointer",onClick:()=>{C(!w)}},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/595/595067.png",width:30,className:"mx-auto"}))),m.createElement("div",{className:"p-3 hover:bg-blue-100"},m.createElement("a",{className:"cursor-pointer"},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/785/785116.png",width:30,className:"mx-auto"}))),m.createElement("div",{className:"p-3 hover:bg-blue-100"},m.createElement("a",{className:"cursor-pointer"},m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/723/723955.png",width:30,className:"mx-auto"}))))))):null,m.createElement("div",{className:"fixed",style:{bottom:"25px",left:"20px",zIndex:10}},m.createElement("a",{className:"cursor-pointer",onClick:()=>{E(!0),c(!0)}},u?null:m.createElement("img",{src:"https://image.flaticon.com/icons/png/512/847/847581.png",width:50}))),u?m.createElement("div",null,m.createElement(Ye,{closeMenu:()=>{E(!1),c(!1)}})):null,m.createElement("div",{className:"fixed",style:{bottom:"2px",right:"260px",zIndex:10}},m.createElement("a",{className:"cursor-pointer",onClick:()=>{h(!y)}},y?null:m.createElement("div",{className:"w-64 p-2 rounded shadow",style:{background:"rgba(0,60,136,.5)"}},m.createElement("div",{className:"text-white"},"Messages"))),y?m.createElement("div",null,m.createElement(Xe,{closeMessageBox:()=>h(!1)})):null))}));var Qe,et=d((({reducer:e})=>({reducer:e})),{handlePropertyModalChange:ke,handleResetProperties:()=>({type:"HANDLE_RESET_PROPERTIES"})})((({reducer:{propertyModal:e,properties:{created:t,createdBy:a,layerName:n,layerType:r,legend:l,refreshRate:s,secure:o,layer:c,dataSourceUrl:i,datalayerSourceId:d,dataLayerId:u,restriction:p}={}}={},handlePropertyModalChange:E,handleResetProperties:y})=>m.createElement(m.Fragment,null,m.createElement(w,{title:"Properties",visible:e,onOk:()=>E(!0),okText:"Ok",onCancel:()=>{y(),E(!1)},footer:null},m.createElement("div",null,m.createElement("div",null,"Created: ",t?new Date(t).toGMTString():""),m.createElement("div",null,"Created By: ",a),m.createElement("div",null,"Layer Name: ",n),m.createElement("div",null,"Layer Type: ",r),m.createElement("div",null,"Legend: ",l),m.createElement("div",null,"Refresh Rate: ",s),m.createElement("div",null,"Secure: ",o),m.createElement("div",null,"Layer: ",c),m.createElement("div",null,"Datasource URL: ",i),m.createElement("div",null,"Datalayer Id: ",u),m.createElement("div",null,"Datalayer Source Id: ",d),m.createElement("div",null,"Organization Restricted: ",p))))));class tt extends p.exports.Component{constructor(e){super(e),i(this,"getFormatType",(e=>{switch(e){case"kml":case"kmz":return new I;case"wfs":case"arcgisent":case"geojson":case"arcgisonline":case"arcgisrest":return new $;case"gpx":return new H;default:return null}})),i(this,"getNodeTreeRightClickMenu",(()=>{const{pageX:e,pageY:t,id:a,categoryName:n,key:r,opacity:l}=this.props.reducer.rightClickNodeTreeItem,s=this.props.reducer.featureLayers.filter((e=>e.key===r)),o={position:"absolute",left:`${e}px`,top:`${t}px`,zIndex:999,width:200,border:"1px solid #99bce8",backgroundColor:"#eee"},c=m.createElement("div",{style:o,className:"shadow border rounded popup",id:"rightPopup"},m.createElement("ul",{className:"mb-0"},m.createElement("li",null,"Add to Room"),m.createElement("li",null,"Rename Layer"),m.createElement("li",null,"Delete Layer"),s.length&&s[0].checked?m.createElement("li",null,m.createElement("div",{onClick:e=>e.stopPropagation()},m.createElement("div",{onClick:()=>{}}," Opacity"),m.createElement(B,{onChange:e=>{this.olmap.getLayers().forEach((t=>{t.get("name")&&null!=t.get("name")&&t.get("name")===r&&t.set("opacity",e/100)})),this.props.handleLayerCheck(r,e/100,"opacity")},value:100*s[0].opacity}))):null,m.createElement("li",null,m.createElement("div",{onClick:e=>{this.props.fetchLayerProperties(r),this.props.handlePropertyModalChange(!0)}},"Properties"))));return t?c:null})),i(this,"addInteraction",(e=>{var t,a=e;(this.olmap.removeInteraction(Qe),"None"!==a)&&("Square"===a?(a="Circle",t=W(4)):"Box"===a?(a="Circle",t=Y()):"add"===a&&this.setState({type:"Point"}),(Qe=new J({source:this.source,type:"add"===a?"Point":a,geometryFunction:t,freehand:"add"===a||this.state.freeDraw})).on("drawend",(e=>{e.feature.setProperties({id:(new Date).getTime()})})),this.olmap.addInteraction(Qe))})),i(this,"addDrawInteraction",(e=>{var t,a=e;(this.olmap.removeInteraction(Qe),"None"!==a)&&("Square"===a?(a="Circle",t=W(4)):"Box"===a?(a="Circle",t=Y()):"add"===a&&this.setState({type:"Point"}),(Qe=new J({source:this.source,type:"add"===a?"Point":a,geometryFunction:t,freehand:!0})).on("drawend",(e=>{e.feature.setProperties({id:(new Date).getTime()})})),this.olmap.addInteraction(Qe))})),i(this,"removeFeature",(()=>{var e=new q;this.olmap.addInteraction(e);var t=e.getFeatures(),a=new K({condition:V});this.olmap.addInteraction(a),a.on("boxend",(e=>{var n=this.olmap.getView().getRotation(),r=n%(Math.PI/2)!=0,l=r?[]:t,s=a.getGeometry().getExtent();if(this.source.forEachFeatureInExtent(s,(e=>{l.push(e)})),r){var o=[0,0],c=a.getGeometry().clone();c.rotate(-n,o);var i=c.getExtent();l.forEach((function(e){var a=e.getGeometry().clone();a.rotate(-n,o),a.intersectsExtent(i)&&t.push(e)}))}})),a.on("boxstart",(function(){t.clear()})),t.on(["add","remove"],(e=>{t.getArray().map((e=>{var t=this.source.getFeatures();if(null!=t&&t.length>0)for(var a in t){if(t[a].getProperties().id==e.get("id")){this.source.removeFeature(t[a]);break}}return e.get("id")}))}))})),i(this,"selectFeature",(()=>{var e=new q;this.olmap.addInteraction(e);var t=e.getFeatures(),a=new K({condition:V});this.olmap.addInteraction(a),a.on("boxend",(e=>{var n=this.olmap.getView().getRotation(),r=n%(Math.PI/2)!=0,l=r?[]:t,s=a.getGeometry().getExtent();if(this.source.forEachFeatureInExtent(s,(e=>{l.push(e)})),r){var o=[0,0],c=a.getGeometry().clone();c.rotate(-n,o);var i=c.getExtent();l.forEach((function(e){var a=e.getGeometry().clone();a.rotate(-n,o),a.intersectsExtent(i)&&t.push(e)}))}})),a.on("boxstart",(function(){t.clear()})),t.on(["add","remove"],(e=>{t.getArray().map((e=>(this.source.getFeatures(),e.get("id"))))}))})),this.state={center:_([-121.4944,38.5816]),zoom:7,type:"",showToolbar:!1,freeDraw:!1,updatedLayer:[],layers:[]},this.source=new T({url:"http://quickmap.dot.ca.gov/data/cctv.kml",format:new I}),this.source.on("addfeature",(e=>{let t=e.feature.getGeometry().getType();if("Point"===this.state.type){e.feature.setProperties({id:"fire",name:"fire",type:t});let a=new D({image:new R({src:"https://www.nwcg.gov/sites/default/files/publications/images/936-point-branch-break.jpg"})});e.feature.setStyle(((e,t)=>(a.getImage().setScale(1/Math.pow(t,.2)),a)))}})),this.setFreeDraw=e=>{this.setState({freeDraw:e})},this.raster=new A({source:new L}),this.vector=[new M({source:this.source})],this.mousePositionControl=new O({coordinateFormat:P(4),projection:"EPSG:4326",className:"custom-mouse-position",target:document.getElementById("mouse-position"),undefinedHTML:"&nbsp;"}),this.olmap=new F({controls:U().extend([this.mousePositionControl]),target:null,layers:[this.raster,...this.vector],view:new j({center:this.state.center,zoom:this.state.zoom})}),Ve.initialize()}updateMap(){this.olmap.getView().setCenter(this.state.center),this.olmap.getView().setZoom(this.state.zoom),this.olmap.getPixelFromCoordinate(this.state.center)}componentDidMount(){this.props.fetchUser(),this.olmap.setTarget("map"),this.olmap.on("moveend",(()=>{let e=this.olmap.getView().getCenter(),t=this.olmap.getView().getZoom();this.setState({center:e,zoom:t})})),document.getElementById("mouse-position").appendChild(document.getElementsByClassName("custom-mouse-position")[0])}shouldComponentUpdate(e,t){let a=this.olmap.getView().getCenter(),n=this.olmap.getView().getZoom();return a!==t.center||n===t.zoom}componentDidUpdate(e,t){e.reducer.featureLayers!==this.props.reducer.featureLayers&&this.props.reducer.featureLayers.forEach((async(e,t)=>{if(e.checked){var a=0;if(this.olmap.getLayers().forEach((async t=>{t&&void 0!==t.get("name")&&t.get("name")===e.key&&(a=1)})),0===a)if("wms"===e.type){var n=e.attributes?JSON.parse(e.attributes):{},r=await new A({name:e.key,opacity:e.opacity,source:new G({url:e.link,tileGrid:z({tileSize:[512,512]}),params:Object.assign({LAYERS:e.layerName,TILED:!0,VERSION:"1.3.0"},n)})});this.olmap.addLayer(r)}else{const t=await new M({opacity:e.opacity,source:new T({url:e.link,format:this.getFormatType(e.type)})});t.set("name",e.key),this.olmap.addLayer(t)}}else this.olmap.getLayers().forEach((t=>{t&&null!=t.get("name")&&t.get("name")&&t.get("name")===e.key&&this.olmap.removeLayer(t)}))}))}userAction(){this.setState({center:[546e3,6868e3],zoom:5})}render(){this.updateMap();const{showMenu:e}=this.props.reducer;return m.createElement(m.Fragment,null,m.createElement("div",{id:"map",style:{width:this.state.showMenu?"80%":"100%",marginLeft:e?"20%":"0%",height:"100vh"}},m.createElement(Ze,{olmap:this.olmap,addInteraction:this.addInteraction,selectFeature:this.selectFeature,removeFeature:this.removeFeature,addDrawInteraction:this.addDrawInteraction,setFreeDraw:this.setFreeDraw,freeDraw:this.state.freeDraw,draw:Qe})),m.createElement("div",{className:"fixed left-95 bottom-5 rounded text-white p-1",style:{background:"rgba(0,60,136,.5)"}},m.createElement("div",{id:"mouse-position",className:"flex items-center"},m.createElement("div",{className:"pr-2"},"Lon, Lat:"))),m.createElement("div",{className:"fixed right-30 bottom-6 rounded text-white p-1",style:{background:"rgba(0,60,136,.5)"}},m.createElement("div",{className:"text-center text-xs"},"ZOOM"),m.createElement("div",{className:"text-sm text-center"},Math.floor(this.state.zoom))),this.getNodeTreeRightClickMenu(),m.createElement(et,null))}}var at=d((({reducer:e})=>({reducer:e})),{fetchUser:()=>({[ie]:{endpoint:ue+"/nics/properties",types:["____","FETCH_USERNAME_SUCCESS","___"],onSuccess:(e,t,a)=>{a(he())}}}),handleLayerCheck:Se,handleOpacityChange:e=>({type:"HANDLE_OPACITY_CHANGE",flag:e}),handlePropertyModalChange:ke,fetchLayerProperties:e=>({[ie]:{endpoint:t=>`${pe}/datalayer/${t.reducer.workspaceId}/layer/${e}`,types:["____","FETCH_PROPERTIES_LAYER_SUCCESS","___"]}})})(tt);const nt={showMenu:!1,opacity:!1,apiCalls:!0,isFetching:!1,user:{},kmlData:[],userDetails:{},currentSessionId:"",incidentType:{},incidents:{},rightClickNodeTreeItem:{pageX:"",pageY:"",id:"",categoryName:"",key:""},propertyModal:!1,common:{incidentName:"No Incident"},maps:{folders:[],datalayerfolders:[]},fire:{folders:[],datalayerfolders:[]},data:{folders:[],datalayerfolders:[]},weather:{folders:[],datalayerfolders:[]},tracking:{folders:[],datalayerfolders:[]},room:{results:[]},mapLayer:[{title:"Maps",key:"maps",children:[{title:"Bing Roads",key:"br"},{title:"Open Street Map",key:"OSM"},{title:"Bing Aerial",key:"BA"},{title:"US Topo - 7.5min quadrangle maps",key:"UST"},{title:"Bing Aerial with Labels",key:"BAL"},{title:"FAA - Sectional Aeronautical Charts",key:"FAA"}]}],featureLayers:[],layers:[{title:"Fire",key:"fire",children:[]},{title:"Weather",key:"weather",children:[]},{title:"Tracking",key:"tracking",children:[]},{title:"Data",key:"data",children:[]}],wfs:[],wms:[],arcgent:[],arcon:[],kml:{baselayer:!0,fileType:"kml",fileURL:"",collabroomId:"",displayname:"",refreshrate:"",orgid:"",fileName:""},georss:{baselayer:!0,fileType:"georss",feedUrl:"",displayname:"",refreshrate:""},geotiff:{filename:"",displayName:"",mosaic:"off",tifFile:""},properties:{created:"",createdBy:"",layerName:"",layerType:"",legend:"",refreshRate:"",secure:"",layer:"",dataSourceUrl:"",datalayerSourceId:"",dataLayerId:"",restriction:""}},rt=(e=nt,t)=>{switch(t.type){case"FETCH_WORKSPACE_SUCCESS":{const a=t.response.workspaces.filter((e=>e.enabled));return c(o({},e),{workspaceId:a[0].workspaceid})}case"HANDLE_KML_CHANGE":return c(o({},e),{kml:o(o({},e.kml),t.obj)});case"HANDLE_KML_SUCCESS":return c(o({},e),{kml:{baselayer:!0,fileType:"kml",fileURL:"",collabroomId:"",displayname:"",refreshrate:"",orgid:"",fileName:""}});case"HANDLE_RESET_PROPERTIES":return c(o({},e),{properties:{created:"",createdBy:"",layerName:"",layerType:"",legend:"",refreshRate:"",secure:"",layer:"",dataSourceUrl:"",datalayerSourceId:"",dataLayerId:"",restriction:""}});case"HANDLE_RIGHT_CLICK_NODE":return c(o({},e),{rightClickNodeTreeItem:o(o({},e.rightClickNodeTreeItem),t.obj)});case"HANDLE_PROPERTY_MODAL_CHANGE":return c(o({},e),{propertyModal:t.val});case"HANDLE_GEOTIFF_CHANGE":return c(o({},e),{geotiff:o(o({},e.geotiff),t.obj)});case"HANDLE_GEORSS_CHANGE":return c(o({},e),{georss:o(o({},e.georss),t.obj)});case"HANDLE_GEORSS_SUCCESS":return c(o({},e),{georss:{baselayer:!0,fileType:"georss",feedUrl:"",displayname:"",refreshrate:""}});case"HANDLE_OPACITY_CHANGE":return c(o({},e),{opacity:t.flag});case"FETCH_USER_DETAIL_SUCCESS":return c(o({},e),{userDetails:t.response});case"FETCH_ARCG_SUCCESS":return c(o({},e),{arcgent:t.response});case"FETCH_ARCG_ONLINE_SUCCESS":return c(o({},e),{arcon:t.response});case"FETCH_WFS_SUCCESS":return c(o({},e),{wfs:t.response});case"FETCH_WMS_SUCCESS":return c(o({},e),{wms:t.response});case"UPDATE_LAYER":return c(o({},e),{layers:t.data});case"FETCH_USERNAME_SUCCESS":return c(o({},e),{user:t.response});case"GET_SESSION_SUCCESS":return c(o({},e),{currentSessionId:t.response.userSession.currentusersessionid});case"FETCH_INCIDENT_TYPE_SUCCESS":return c(o({},e),{incidentType:t.response});case"FETCH_INCIDENT_TREE_SUCCESS":return c(o({},e),{incidents:t.response});case"FETCH_MAPS_SUCCESS":return c(o({},e),{maps:t.response});case"HANDLE_MENU_BAR":return c(o({},e),{showMenu:t.flag});case"FETCH_FIRE_SUCCESS":{const a=e.layers,n=e.featureLayers,{datalayerfolders:r,folders:l}=t.response,s=r.map((e=>{const t=ye(e.datalayer.datalayersource.datasource.datasourcetype.typename,e.datalayer.datalayersource,e.datalayer);return{title:e.datalayer.displayname,link:t,type:e.datalayer.datalayersource.datasource.datasourcetype.typename,key:e.datalayerid,checked:!1,opacity:1,loaded:!1,layerName:e.datalayer.datalayersource.layername,attributes:e.datalayer.datalayersource.attributes}})),i=l.map((e=>({title:e.foldername,link:"",type:"folder",key:e.folderid})));return a[0].children.push(...i,...s),n.push(...s),c(o({},e),{fire:t.response,apiCalls:!1,layers:a,featureLayers:n})}case"FETCH_DATA_SUCCESS":{const a=e.layers,n=e.featureLayers,{datalayerfolders:r,folders:l}=t.response,s=r.map((e=>{const t=ye(e.datalayer.datalayersource.datasource.datasourcetype.typename,e.datalayer.datalayersource,e.datalayer);return{title:e.datalayer.displayname,link:t,type:e.datalayer.datalayersource.datasource.datasourcetype.typename,key:e.datalayerid,checked:!1,opacity:1,loaded:!1,layerName:e.datalayer.datalayersource.layername,attributes:e.datalayer.datalayersource.attributes}})),i=l.map((e=>({title:e.foldername,link:"",type:"folder",key:e.folderid})));return a[3].children.push(...i,...s),n.push(...s),c(o({},e),{data:t.response,layers:a,featureLayers:n})}case"FETCH_PROPERTIES_LAYER_SUCCESS":{const{response:a}=t,{created:n,datalayerid:r,displayname:l,datalayersourceid:s,legend:i,datalayersource:{refreshrate:d,layername:m,datasource:{internalurl:u,secure:p,datasourcetype:{typename:E}}},usersession:{userorg:{user:{username:y}}={}}}=a.datalayers[0];return c(o({},e),{properties:{created:n,createdBy:y,layerName:l,layerType:E,legend:i,refreshRate:d,secure:p?"true":"false",layer:m,dataSourceUrl:u,datalayerSourceId:s,dataLayerId:r,restriction:t.response.datalayerOrgs&&t.response.datalayerOrgs.length?"true":"false"}})}case"FETCH_WEATHER_SUCCESS":{const a=e.layers,n=e.featureLayers,{datalayerfolders:r,folders:l}=t.response,s=r.map((e=>{const t=ye(e.datalayer.datalayersource.datasource.datasourcetype.typename,e.datalayer.datalayersource,e.datalayer);return{title:e.datalayer.displayname,link:t,type:e.datalayer.datalayersource.datasource.datasourcetype.typename,key:e.datalayerid,checked:!1,opacity:1,loaded:!1,layerName:e.datalayer.datalayersource.layername,attributes:e.datalayer.datalayersource.attributes}})),i=l.map((e=>({title:e.foldername,link:"",type:"folder",key:e.folderid})));return a[1].children.push(...i,...s),n.push(...s),c(o({},e),{weather:t.response,layers:a,featureLayers:n})}case"FETCH_TRACKING_SUCCESS":{const a=e.layers,n=e.featureLayers,{datalayerfolders:r,folders:l}=t.response,s=r.map((e=>{const t=ye(e.datalayer.datalayersource.datasource.datasourcetype.typename,e.datalayer.datalayersource,e.datalayer);return{title:e.datalayer.displayname,link:t,type:e.datalayer.datalayersource.datasource.datasourcetype.typename,key:e.datalayerid,checked:!1,opacity:1,loaded:!1,layerName:e.datalayer.datalayersource.layername,attributes:e.datalayer.datalayersource.attributes}})),i=l.map((e=>({title:e.foldername,link:"",type:"folder",key:e.folderid})));return a[2].children.push(...i,...s),n.push(...s),c(o({},e),{tracking:t.response,layers:a,featureLayers:n})}case"HANDLE_FOLDER_DATA":{const{datalayerfolders:a,folders:n}=t.response,r=e.featureLayers,l=e.layers[Ee[t.folderType]].children.map((e=>{if("folder"===e.type&&e.key===t.response.rootId){e.children=[];const t=a.map((e=>{const t=ye(e.datalayer.datalayersource.datasource.datasourcetype.typename,e.datalayer.datalayersource,e.datalayer);return{title:e.datalayer.displayname,link:t,type:e.datalayer.datalayersource.datasource.datasourcetype.typename,key:e.datalayerid,checked:!1,opacity:1,loaded:!1}})),l=n.map((e=>({title:e.foldername,link:"",type:"folder",key:e.folderid})));e.children.push(...l,...t),r.push(...t)}return e})),s=e.layers;return s[Ee[t.folderType]]=c(o({},s[Ee[t.folderType]]),{children:l}),c(o({},e),{layers:s})}case"FETCH_ROOMS_SUCCESS":return c(o({},e),{room:t.response});case"HANDLE_INCIDENT_NAME":return c(o({},e),{common:{incidentName:t.name}});case"HANDLE_LAYER_CHECK_FLAG":{const a=e.featureLayers.map((e=>(e.key===t.key&&(e[t.flagKey]=t.flag),e)));return c(o({},e),{featureLayers:a})}default:return e}};let lt;function st(e){const t=lt(X(o({reducer:rt},a)),e);var a;return t.asyncReducers={},t}Z.exports.createLogger({level:"info",collapsed:!1}),lt=Q(ee(ae,(e=>t=>a=>{const n=a[ie];if(void 0===n)return t(a);let{endpoint:r}=n;const{types:l}=n;if("function"==typeof r&&(r=r(e.getState())),"string"!=typeof r)throw new Error("Specify a string endpoint URL.");if(!Array.isArray(l)||3!==l.length)throw new Error("Expected an array of three action types.");if(!l.every((e=>"string"==typeof e)))throw new Error("Expected action types to be strings.");const[s,i,d]=l;function m(e){const t=o(o({},a),e);return delete t[ie],t}function u(a){n.successTypeActionProps?t(m(c(o({response:a},n.successTypeActionProps),{type:i}))):t(m({response:a,type:i}));const{onSuccess:r}=n;if(r){if("function"!=typeof r)throw new Error("Success Callback should be a function");r(a,e.getState(),e.dispatch)}}function p(){return function({endpoint:e,timeout:t}){return Promise.race([ce(e),new Promise(((a,n)=>{const r=setTimeout((()=>{n({status:500,message:"Request timed out"})}),t);oe[e]=r}))])}({endpoint:r,timeout:6e4}).then(u,E)}function E(a){switch(a.status=a.status||0,a.status){case 401:if(Object.keys(e.getState()).includes("dashboard"))return window.location.href="https://sellerpad.io/main/#/login",!1}t(m({type:d,error:a.message||"Something bad happened"}));const{onFailure:r}=n;if(r){if("function"!=typeof r)throw new Error("Failure Callback should be a function");r(a,e.getState(),e.dispatch)}}let y={type:s};n.requestTypeActionProps&&(y=o(o({},y),n.requestTypeActionProps)),t(m(y));const{validator:h}=n;let{toValidate:g}=n;if("function"==typeof h&&"function"!=typeof g)throw new Error("Expected toValidate to be a function since you supplied a validator method");return h?("function"==typeof g&&(g=g(e.getState())),h.validate(g).then((e=>{if(e.valid)return p();let a={type:d,errors:e.errors};return n.failureTypeActionProps&&(a=o(o({},a),n.failureTypeActionProps)),Promise.resolve(t(m(a)))}))):p()}),(e=>t=>a=>{const n=a[me];if(void 0===n)return t(a);let{endpoint:r,payload:l}=n;const{method:s="post",types:i}=n,[d,m,u]=i;if("function"==typeof r&&(r=r(e.getState())),"string"!=typeof r)throw new Error("Specify a string endpoint URL.");if("function"==typeof l&&(l=l(e.getState())),"object"!=typeof l)throw new Error("Specify the payload for POST request");if(!Array.isArray(i)||3!==i.length)throw new Error("Expected an array of three action types.");if(!i.every((e=>"string"==typeof e)))throw new Error("Expected action types to be strings.");function p(e){const t=o(o({},a),e);return delete t[me],t}function E(){const{payloadAsIs:a=!1}=n,{isPayloadJson:i=!1}=n,{skipCsrfToken:d=!1}=n;return de({endpoint:r,payload:l,method:s,payloadAsIs:a,isPayloadJson:i,skipCsrfToken:d}).then((a=>{n.successTypeActionProps?t(p(c(o({response:a},n.successTypeActionProps),{type:m}))):t(p({response:a,type:m}));const{onSuccess:r}=n;if(r){if("function"!=typeof r)throw new Error("Success Callback should be a function");r(a,e.getState(),e.dispatch)}}),(({status:a,json:r})=>{if(console.log(r,n,"jso"),void 0!==a)try{console.log(r);let a={errors:n.failureActionErrors?n.failureActionErrors(JSON.parse(r),e.getState(),e.dispatch):r?JSON.parse(r):null};if(!a.errors)throw console.error("failureActionErrors should be a function"),new Error("failureActionErrors should be a function");n.failureTypeActionProps&&(a=o(o({},a),n.failureTypeActionProps)),t(p(o({type:u},a)));const{onFailure:l}=n;if(l){if("function"!=typeof l)throw new Error("Failure Callback should be a function");l(r,e.getState(),e.dispatch)}}catch(l){console.error(l.stack)}}))}let{validator:y}=n,{toValidate:h}=n;if("function"==typeof y&&"function"!=typeof h)throw new Error("Expected toValidate to be a function since you supplied a validator method");let g={type:d};if(n.requestTypeActionProps&&(g=o(o({},g),n.requestTypeActionProps)),t(p(g)),y){if("function"==typeof h&&(h=h(e.getState())),!("validate"in y)&&(y=y(e.getState()),!("validate"in y)))throw new Error("Expected Validator to be instance of LGTM");return y.validate(h).then((e=>{if(e.valid)return E();let a={type:u,errors:e.errors};return n.failureTypeActionProps&&(a=o(o({},a),n.failureTypeActionProps)),Promise.all([t(p(a))])}))}return E()})))(te);const ot=()=>{const e=st();return m.createElement(ne,{store:e},m.createElement("div",{className:"overflow-hidden"},m.createElement(se,null),m.createElement(at,null)))};re.render(m.createElement(m.StrictMode,null,m.createElement(ot,null)),document.getElementById("root"));
